# Backtest mode focused template.

# Optional: Databento Historical API key for DBN retrieval scripts.
# DATABENTO_API_KEY=...

BACKTEST_DATA_PARQUET=data/parquet/mbp10
# Example single file input:
# BACKTEST_DATA_PARQUET=data/parquet/mbp10.parquet
BACKTEST_INITIAL_CASH=10000
BACKTEST_FEE_PER_ORDER=1.0
BACKTEST_SLIPPAGE_BPS=1.0
BACKTEST_SLIP_ENTRY_TICKS=0.0
BACKTEST_SLIP_STOP_TICKS=0.0
BACKTEST_SLIP_TP_TICKS=0.0
BACKTEST_SPREAD_SLIP_K=1.0
BACKTEST_ENTRY_DELAY_EVENTS=1
BACKTEST_CANDIDATE_MONTHS=0
BACKTEST_WALK_FORWARD=false
# Note: parquet orderflow currently supports full-dataset and latest-month windows.
BACKTEST_WF_WINDOW_MONTHS=6
BACKTEST_WF_STEP_MONTHS=1
BACKTEST_ORDERFLOW_SESSION_ONLY=true
BACKTEST_PARQUET_BATCH_SIZE=200000
# BACKTEST_WF_START_UTC=2025-01-01T00:00:00Z
# BACKTEST_WF_END_UTC=2026-01-01T00:00:00Z
BACKTEST_CANDIDATES_PARQUET=artifacts/telemetry/backtest_candidates.parquet
BACKTEST_MATRIX_PARQUET=artifacts/telemetry/backtest_candidate_matrix.parquet
BACKTEST_SUMMARY_PARQUET=artifacts/telemetry/backtest_summary.parquet
BACKTEST_BAR_SEC=60
# Optional fast-test cap; loads only the first N rows when >0.
BACKTEST_MAX_ROWS=0
BACKTEST_HEALTH_STRICT=false
BACKTEST_HEALTH_MIN_CANDIDATES=1
BACKTEST_HEALTH_MIN_TRADES=1
BACKTEST_HEALTH_MAX_DRAWDOWN_PCT=50
BACKTEST_SHADOW_ML_ENABLED=false
BACKTEST_SHADOW_ML_MODEL_PATH=artifacts/models/xgboost_model.json
BACKTEST_SHADOW_ML_MIN_PROBA=0.55
BACKTEST_PREFLIGHT_STRICT=true
BACKTEST_PREFLIGHT_REQUIRE_SEQ=true
BACKTEST_PREFLIGHT_MIN_ROWS=1
BACKTEST_PREFLIGHT_MIN_QUOTE_COVERAGE=0.90
BACKTEST_PREFLIGHT_MIN_DEPTH_COVERAGE=0.90
BACKTEST_PREFLIGHT_MIN_SESSION_ROWS=1
BACKTEST_SENSITIVITY_SWEEP=false
BACKTEST_SWEEP_ENTRY_DELAYS=0,1,2
BACKTEST_SWEEP_SLIP_ENTRY_TICKS=0,0.5,1.0
BACKTEST_SWEEP_SPREAD_SLIP_K=0,1,2
BACKTEST_NEWS_PATH=data/news_usd_major.parquet
BACKTEST_NEWS_PRE_MIN=15
BACKTEST_NEWS_POST_MIN=15
BACKTEST_NEWS_MAJOR_ONLY=true
BACKTEST_NEWS_CURRENCIES=USD

SYMBOL=MNQ
SIZE=1

# Backtest requires orderflow parquet input with depth-capable fields.
STRAT_AVOID_NEWS=true
STRAT_NEWS_EXIT_ON_EVENT=false
STRAT_HTF_AGGREGATION=15
STRAT_BIAS_AGGREGATION=60
RUNTIME_PROFILE=normal
TELEMETRY_DIR=artifacts/telemetry
TELEMETRY_CANDIDATES_FILE=candidate_trades.jsonl
TELEMETRY_PERF_FILE=performance.jsonl

STRAT_ACCOUNT_MAX_DRAWDOWN=2000
ACCOUNT_MAX_DRAWDOWN_KILLSWITCH=2000
ACCOUNT_MAX_DRAWDOWN=2000
STRAT_MAX_TRADE_DRAWDOWN_FRACTION=0.15
STRAT_MIN_RRR=3.0
STRAT_MAX_RRR=10.0
STRAT_SL_NOISE_BUFFER_TICKS=2
STRAT_SL_MAX_TICKS=200
STRAT_TP_FRONT_RUN_TICKS=2
STRAT_ENABLE_EXHAUSTION_MARKET_EXIT=true
